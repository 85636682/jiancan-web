<%= render 'navbar' %>
<table class="table table-border" style="width:96%;height:100%;border-color: #C2C8CF;">
  <tbody>
    <tr>
      <td colspan="4">
        营业额统计
      </td>
    </tr>
    <tr>
      <td colspan="4">
        <canvas id="myChart"  style="width:100%;height:100%"></canvas>
      </td>
    </tr>
    <tr style="background-color: #D8DEE6;">
      <td>总数</td>
      <td>平均</td>
      <td>最高</td>
      <td>最低</td>
    </tr>
    <tr>
      <td><%= @totals.sum %></td>
      <td><%= @totals.reduce(:+).to_f / @totals.size %></td>
      <td><%= @totals.max %></td>
      <td><%= @totals.min %></td>
    </tr>
  </tbody>
</table>

<script>
	var randomScalingFactor = function(){ return Math.round(Math.random()*100)};
	var lineChartData = {
		labels : [moment().subtract(6,'d').format('MM/DD'), moment().subtract(5,'d').format('MM/DD'),
              moment().subtract(4,'d').format('MM/DD'), moment().subtract(3,'d').format('MM/DD'),
              moment().subtract(2,'d').format('MM/DD'), moment().subtract(1,'d').format('MM/DD'),
              moment().format('MM/DD')],
		datasets : [
			{
				label: "My First dataset",
				fillColor : "rgba(220,220,220,0.2)",
				strokeColor : "rgba(220,220,220,1)",
				pointColor : "rgba(220,220,220,1)",
				pointStrokeColor : "#fff",
				pointHighlightFill : "#fff",
				pointHighlightStroke : "rgba(220,220,220,1)",
				data : <%= @totals %>
			}
		]
	};
	window.onload = function(){
		var ctx = document.getElementById("myChart").getContext("2d");
		window.myLine = new Chart(ctx).Line(lineChartData, {
			responsive: true
		});
	}
</script>
