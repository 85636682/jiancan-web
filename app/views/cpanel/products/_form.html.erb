<%= form_for [:cpanel, @product] do |f| %>
  <%= f.hidden_field :shop_id, value: @shop.id %>
  <div class="form-group row">
    <label for="inputEmail3" class="col-sm-2 form-control-label">商品名称</label>
    <div class="col-sm-10">
      <%= f.text_field :name, class: "form-control", placeholder: "名称" %>
    </div>
  </div>
  <div class="form-group row">
    <label for="inputPassword3" class="col-sm-2 form-control-label">商品价钱</label>
    <div class="col-sm-10">
      <%= f.text_field :price, class: "form-control", placeholder: "价钱" %>
    </div>
  </div>
  <div class="form-group row">
    <label for="inputPassword3" class="col-sm-2 form-control-label">所属分类</label>
    <div class="col-sm-10" style="padding-top:8px;">
      <%= f.collection_select(:category_id, @shop.categories, :id, :name, { :prompt => "选择分类" }, { :class => "form-control" }) %>
    </div>
  </div>
  <div class="form-group row">
    <label for="inputAvatar" class="col-sm-2 form-control-label">店铺头像</label>
    <div class="col-sm-1">
      <%= image_tag(@product.avatar.url("80x80"), :alt=>"店铺头像", :class=>"img-circle", :width => "40", :height => "40", :id => "show_avatar") %>
    </div>
    <div class="col-sm-9">
      <label class="file">
        <%= f.file_field :avatar %>
        <span class="file-custom"></span>
      </label>
    </div>
  </div>
  <% if not @product.new_record? %>
  <div class="form-group row">
    <label for="inputPassword3" class="col-sm-2 form-control-label">二维码</label>
    <div class="col-sm-10">
      <div id="qrcode"></div>
    </div>
  </div>
  <script>
    $('#qrcode').qrcode({width: 64, height: 64, text: "{ product_id: <%= @product.id %> }"});

    $("#product_avatar").change(function(){
      if (this.files && this.files[0]) {
        var reader = new FileReader();

        reader.onload = function (e) {
            $('#show_avatar').attr('src', e.target.result);
        }

        reader.readAsDataURL(this.files[0]);
      }
    });
  </script>
  <% end %>
  <div class="form-group row">
    <label for="inputEmail3" class="col-sm-2 form-control-label"></label>
    <div class="col-sm-10">
      <%= f.submit "保 存", class: "btn btn-primary btn-lg btn-block" %>
    </div>
  </div>
  
<% end %>